import{f as B,g as c,E as a,Z as D,u as t,o as r,h as u,w as h,c as R,a1 as b,a0 as y,b as F,F as T,a8 as g,U as I,d as N,t as L,a4 as M,aK as z,cb as V,_ as A}from"./app.8dd14888.js";import{H as P}from"./index.355b45a7.js";import{H as K}from"./index.d64daf0b.js";import{H as W}from"./index.94d2d346.js";import{v as Z}from"./directive.f56750b0.js";import{E as G}from"./index.faa03e17.js";import{E as J}from"./index.1ac4a68e.js";const S={width:"200px",height:"100px",src:"",fit:"contain",icon:"Plus",iconSize:30},_={icon:"Upload",type:"primary",size:"",text:"\u4E0A\u4F20\u56FE\u7247"},Q={accept:{type:String,default:".jpg,.jpeg,.png"},type:{type:String,default:"image"},imageOptions:{type:Object,default:()=>S},buttonOptions:{type:Object,default:()=>_},maxSize:{type:Number,default:2*1024*1024},httpRequest:{type:Function},beforeUpload:{type:Function},cropper:{type:Boolean,default:!1},cropperOption:{type:Object,default:()=>{}}},X=B({__name:"index",props:Q,emits:["error"],setup(O,{emit:E}){const s=O,n=c(!1),f=c(""),d=c(!1),m=c(),i=a(()=>{const e={...S,...s.imageOptions};return f.value&&(e.src=f.value),e}),p=a(()=>({..._,...s.buttonOptions})),U=a(()=>!!i.value.src),k=a(()=>{const e=i.value;return{width:e.width,height:e.height,"line-height":e.height}}),w=a(()=>{const e=i.value;return{width:e.width,height:e.height,"line-height":e.height,"font-size":`${e.iconSize}px`}}),C=a(()=>s.type==="image"),H=a(()=>s.type==="button"),q=e=>{if(e.size>s.maxSize){const o=`\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 ${s.maxSize/1024/1024}M`;return E("error",o),!1}return s.beforeUpload?s.beforeUpload(e)?(n.value=!0,!0):!1:(n.value=!0,!0)},x=e=>{const o=q(e);return o&&s.cropper?(m.value=e,M(()=>{d.value=!0}),!1):o},v=({file:e})=>{if(!!z&&s.httpRequest){const o=z.URL.createObjectURL(e),l=()=>{f.value=o,n.value=!1};s.httpRequest(e,l,o)}},$=()=>{n.value=!1},j=(e,o)=>{const l=V.blobToFile(o,"cropper.jpg");v({file:l})};return(e,o)=>D((r(),u(t(J),{class:y([e.$style.uploader,`upload-type-${e.type}`]),action:"","show-file-list":!1,accept:e.accept,"http-request":v,"before-upload":x},{default:h(()=>[t(C)?(r(),R(T,{key:0},[t(U)?(r(),u(t(G),{key:0,src:t(i).src,fit:t(i).fit,style:b(t(k)),class:y(e.$style.photo)},{placeholder:h(()=>[F("\u52A0\u8F7D\u4E2D")]),_:1},8,["src","fit","style","class"])):(r(),u(P,{key:1,name:t(i).icon,class:y([e.$style.icon]),style:b(t(w))},null,8,["name","class","style"]))],64)):g("v-if",!0),t(H)?I(e.$slots,"default",{key:1},()=>[N(K,{size:t(p).size,type:t(p).type,icon:{name:t(p).icon}},{default:h(()=>[F(L(t(p).text),1)]),_:1},8,["size","type","icon"])]):g("v-if",!0),e.cropper&&m.value?(r(),u(W,{key:2,visible:d.value,"onUpdate:visible":o[0]||(o[0]=l=>d.value=l),image:m.value,option:e.cropperOption,dialog:"",onFinished:j,onCancel:$},null,8,["visible","image","option"])):g("v-if",!0)]),_:3},8,["class","accept"])),[[t(Z),n.value]])}}),Y="_uploader_e7qei_1",ee="_icon_e7qei_18",te="_photo_e7qei_26",oe={uploader:Y,icon:ee,photo:te},se={$style:oe},ue=A(X,[["__cssModules",se],["__file","index.vue"]]);export{ue as H};
