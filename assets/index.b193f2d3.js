import{f as H,z as P,K as ye,n as Z,o as g,c as S,X as y,u as e,a as B,Y as j,R as F,t as W,a4 as $,h as D,w as _,a3 as ge,N as C,g as re,aj as he,at as le,d as O,as as I,F as be,bS as ke,y as $e,B as we,az as J,c3 as Ee,G as x,ag as Se,O as Ce,D as Re,H as Pe,av as ee,T as te}from"./app.8c8a4a35.js";import{e as q,p as h,u as M,av as Fe,aw as ie,N as _e,ax as ue,a5 as de,s as A,_ as K,w as ce,v as Q,T as Le,G as Te,ay as Ue,az as De,aA as Oe,aB as Be,m as Ne,i as je}from"./document.119ae42e.js";import{m as Y}from"./typescript.72bf8adc.js";const pe=Symbol("uploadContextKey"),Ae=q({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:o=>o>=0&&o<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:h(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:h([String,Array,Function]),default:""},format:{type:h(Function),default:o=>`${o}%`}}),Ie=["aria-valuenow"],Me={viewBox:"0 0 100 100"},qe=["d","stroke","stroke-width"],ze=["d","stroke","opacity","stroke-linecap","stroke-width"],He={key:0},Ke={name:"ElProgress"},We=H({...Ke,props:Ae,setup(o){const s=o,n={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=M("progress"),d=P(()=>({width:`${s.percentage}%`,animationDuration:`${s.duration}s`,backgroundColor:E(s.percentage)})),p=P(()=>(s.strokeWidth/s.width*100).toFixed(1)),f=P(()=>["circle","dashboard"].includes(s.type)?Number.parseInt(`${50-Number.parseFloat(p.value)/2}`,10):0),R=P(()=>{const l=f.value,L=s.type==="dashboard";return`
          M 50 50
          m 0 ${L?"":"-"}${l}
          a ${l} ${l} 0 1 1 0 ${L?"-":""}${l*2}
          a ${l} ${l} 0 1 1 0 ${L?"":"-"}${l*2}
          `}),u=P(()=>2*Math.PI*f.value),b=P(()=>s.type==="dashboard"?.75:1),c=P(()=>`${-1*u.value*(1-b.value)/2}px`),w=P(()=>({strokeDasharray:`${u.value*b.value}px, ${u.value}px`,strokeDashoffset:c.value})),i=P(()=>({strokeDasharray:`${u.value*b.value*(s.percentage/100)}px, ${u.value}px`,strokeDashoffset:c.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),t=P(()=>{let l;return s.color?l=E(s.percentage):l=n[s.status]||n.default,l}),r=P(()=>s.status==="warning"?Fe:s.type==="line"?s.status==="success"?ie:_e:s.status==="success"?ue:de),v=P(()=>s.type==="line"?12+s.strokeWidth*.4:s.width*.111111+2),k=P(()=>s.format(s.percentage));function m(l){const L=100/l.length;return l.map((U,N)=>Z(U)?{color:U,percentage:(N+1)*L}:U).sort((U,N)=>U.percentage-N.percentage)}const E=l=>{var L;const{color:T}=s;if(ye(T))return T(l);if(Z(T))return T;{const U=m(T);for(const N of U)if(N.percentage>l)return N.color;return(L=U[U.length-1])==null?void 0:L.color}};return(l,L)=>(g(),S("div",{class:y([e(a).b(),e(a).m(l.type),e(a).is(l.status),{[e(a).m("without-text")]:!l.showText,[e(a).m("text-inside")]:l.textInside}]),role:"progressbar","aria-valuenow":l.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[l.type==="line"?(g(),S("div",{key:0,class:y(e(a).b("bar"))},[B("div",{class:y(e(a).be("bar","outer")),style:j({height:`${l.strokeWidth}px`})},[B("div",{class:y([e(a).be("bar","inner"),{[e(a).bem("bar","inner","indeterminate")]:l.indeterminate}]),style:j(e(d))},[(l.showText||l.$slots.default)&&l.textInside?(g(),S("div",{key:0,class:y(e(a).be("bar","innerText"))},[F(l.$slots,"default",{percentage:l.percentage},()=>[B("span",null,W(e(k)),1)])],2)):$("v-if",!0)],6)],6)],2)):(g(),S("div",{key:1,class:y(e(a).b("circle")),style:j({height:`${l.width}px`,width:`${l.width}px`})},[(g(),S("svg",Me,[B("path",{class:y(e(a).be("circle","track")),d:e(R),stroke:`var(${e(a).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":e(p),fill:"none",style:j(e(w))},null,14,qe),B("path",{class:y(e(a).be("circle","path")),d:e(R),stroke:e(t),fill:"none",opacity:l.percentage?1:0,"stroke-linecap":l.strokeLinecap,"stroke-width":e(p),style:j(e(i))},null,14,ze)]))],6)),(l.showText||l.$slots.default)&&!l.textInside?(g(),S("div",{key:2,class:y(e(a).e("text")),style:j({fontSize:`${e(v)}px`})},[F(l.$slots,"default",{percentage:l.percentage},()=>[l.status?(g(),D(e(A),{key:1},{default:_(()=>[(g(),D(ge(e(r))))]),_:1})):(g(),S("span",He,W(e(k)),1))])],6)):$("v-if",!0)],10,Ie))}});var Ve=K(We,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const Xe=ce(Ve),Ge="ElUpload";class Je extends Error{constructor(s,n,a,d){super(s),this.name="UploadAjaxError",this.status=n,this.method=a,this.url=d}}function se(o,s,n){let a;return n.response?a=`${n.response.error||n.response}`:n.responseText?a=`${n.responseText}`:a=`fail to ${s.method} ${o} ${n.status}`,new Je(a,n.status,s.method,o)}function Ye(o){const s=o.responseText||o.response;if(!s)return s;try{return JSON.parse(s)}catch{return s}}const Qe=o=>{typeof XMLHttpRequest>"u"&&Q(Ge,"XMLHttpRequest is undefined");const s=new XMLHttpRequest,n=o.action;s.upload&&s.upload.addEventListener("progress",p=>{const f=p;f.percent=p.total>0?p.loaded/p.total*100:0,o.onProgress(f)});const a=new FormData;if(o.data)for(const[p,f]of Object.entries(o.data))Array.isArray(f)?a.append(p,...f):a.append(p,f);a.append(o.filename,o.file,o.file.name),s.addEventListener("error",()=>{o.onError(se(n,o,s))}),s.addEventListener("load",()=>{if(s.status<200||s.status>=300)return o.onError(se(n,o,s));o.onSuccess(Ye(s))}),s.open(o.method,n,!0),o.withCredentials&&"withCredentials"in s&&(s.withCredentials=!0);const d=o.headers||{};if(d instanceof Headers)d.forEach((p,f)=>s.setRequestHeader(f,p));else for(const[p,f]of Object.entries(d))Le(f)||s.setRequestHeader(p,String(f));return s.send(a),s},fe=["text","picture","picture-card"];let Ze=1;const ve=()=>Date.now()+Ze++,me=q({action:{type:String,default:"#"},headers:{type:h(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>Y({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:h(Array),default:()=>Y([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:fe,default:"text"},httpRequest:{type:h(Function),default:Qe},disabled:Boolean,limit:Number}),xe=q({...me,beforeUpload:{type:h(Function),default:C},beforeRemove:{type:h(Function)},onRemove:{type:h(Function),default:C},onChange:{type:h(Function),default:C},onPreview:{type:h(Function),default:C},onSuccess:{type:h(Function),default:C},onProgress:{type:h(Function),default:C},onError:{type:h(Function),default:C},onExceed:{type:h(Function),default:C}}),et=q({files:{type:h(Array),default:()=>Y([])},disabled:{type:Boolean,default:!1},handlePreview:{type:h(Function),default:C},listType:{type:String,values:fe,default:"text"}}),tt={remove:o=>!!o},st=["onKeydown"],at=["src"],ot=["onClick"],nt=["onClick"],rt=["onClick"],lt={name:"ElUploadList"},it=H({...lt,props:et,emits:tt,setup(o,{emit:s}){const{t:n}=Te(),a=M("upload"),d=M("icon"),p=M("list"),f=re(!1),R=u=>{s("remove",u)};return(u,b)=>(g(),D(ke,{tag:"ul",class:y([e(a).b("list"),e(a).bm("list",u.listType),e(a).is("disabled",u.disabled)]),name:e(p).b()},{default:_(()=>[(g(!0),S(be,null,he(u.files,c=>(g(),S("li",{key:c.uid||c.name,class:y([e(a).be("list","item"),e(a).is(c.status),{focusing:f.value}]),tabindex:"0",onKeydown:le(w=>!u.disabled&&R(c),["delete"]),onFocus:b[0]||(b[0]=w=>f.value=!0),onBlur:b[1]||(b[1]=w=>f.value=!1),onClick:b[2]||(b[2]=w=>f.value=!1)},[F(u.$slots,"default",{file:c},()=>[u.listType==="picture"||c.status!=="uploading"&&u.listType==="picture-card"?(g(),S("img",{key:0,class:y(e(a).be("list","item-thumbnail")),src:c.url,alt:""},null,10,at)):$("v-if",!0),c.status==="uploading"||u.listType!=="picture-card"?(g(),S("div",{key:1,class:y(e(a).be("list","item-info"))},[B("a",{class:y(e(a).be("list","item-name")),onClick:I(w=>u.handlePreview(c),["prevent"])},[O(e(A),{class:y(e(d).m("document"))},{default:_(()=>[O(e(Ue))]),_:1},8,["class"]),B("span",{class:y(e(a).be("list","item-file-name"))},W(c.name),3)],10,ot),c.status==="uploading"?(g(),D(e(Xe),{key:0,type:u.listType==="picture-card"?"circle":"line","stroke-width":u.listType==="picture-card"?6:2,percentage:Number(c.percentage),style:j(u.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):$("v-if",!0)],2)):$("v-if",!0),B("label",{class:y(e(a).be("list","item-status-label"))},[u.listType==="text"?(g(),D(e(A),{key:0,class:y([e(d).m("upload-success"),e(d).m("circle-check")])},{default:_(()=>[O(e(ie))]),_:1},8,["class"])):["picture-card","picture"].includes(u.listType)?(g(),D(e(A),{key:1,class:y([e(d).m("upload-success"),e(d).m("check")])},{default:_(()=>[O(e(ue))]),_:1},8,["class"])):$("v-if",!0)],2),u.disabled?$("v-if",!0):(g(),D(e(A),{key:2,class:y(e(d).m("close")),onClick:w=>R(c)},{default:_(()=>[O(e(de))]),_:2},1032,["class","onClick"])),$(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),$(" This is a bug which needs to be fixed "),$(" TODO: Fix the incorrect navigation interaction "),u.disabled?$("v-if",!0):(g(),S("i",{key:3,class:y(e(d).m("close-tip"))},W(e(n)("el.upload.deleteTip")),3)),u.listType==="picture-card"?(g(),S("span",{key:4,class:y(e(a).be("list","item-actions"))},[B("span",{class:y(e(a).be("list","item-preview")),onClick:w=>u.handlePreview(c)},[O(e(A),{class:y(e(d).m("zoom-in"))},{default:_(()=>[O(e(De))]),_:1},8,["class"])],10,nt),u.disabled?$("v-if",!0):(g(),S("span",{key:0,class:y(e(a).be("list","item-delete")),onClick:w=>R(c)},[O(e(A),{class:y(e(d).m("delete"))},{default:_(()=>[O(e(Oe))]),_:1},8,["class"])],10,rt))],2)):$("v-if",!0)])],42,st))),128)),F(u.$slots,"append")]),_:3},8,["class","name"]))}});var ae=K(it,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const ut=q({disabled:{type:Boolean,default:!1}}),dt={file:o=>$e(o)},ct=["onDrop","onDragover"],pt={name:"ElUploadDrag"},ft=H({...pt,props:ut,emits:dt,setup(o,{emit:s}){const n=o,a="ElUploadDrag",d=we(pe);d||Q(a,"usage: <el-upload><el-upload-dragger /></el-upload>");const p=M("upload"),f=re(!1),R=b=>{if(n.disabled)return;f.value=!1;const c=Array.from(b.dataTransfer.files),w=d.accept.value;if(!w){s("file",c);return}const i=c.filter(t=>{const{type:r,name:v}=t,k=v.includes(".")?`.${v.split(".").pop()}`:"",m=r.replace(/\/.*$/,"");return w.split(",").map(E=>E.trim()).filter(E=>E).some(E=>E.startsWith(".")?k===E:/\/\*$/.test(E)?m===E.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(E)?r===E:!1)});s("file",i)},u=()=>{n.disabled||(f.value=!0)};return(b,c)=>(g(),S("div",{class:y([e(p).b("dragger"),e(p).is("dragover",f.value)]),onDrop:I(R,["prevent"]),onDragover:I(u,["prevent"]),onDragleave:c[0]||(c[0]=I(w=>f.value=!1,["prevent"]))},[F(b.$slots,"default")],42,ct))}});var vt=K(ft,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const mt=q({...me,beforeUpload:{type:h(Function),default:C},onRemove:{type:h(Function),default:C},onStart:{type:h(Function),default:C},onSuccess:{type:h(Function),default:C},onProgress:{type:h(Function),default:C},onError:{type:h(Function),default:C},onExceed:{type:h(Function),default:C}}),yt=["onKeydown"],gt=["name","multiple","accept"],ht={name:"ElUploadContent",inheritAttrs:!1},bt=H({...ht,props:mt,setup(o,{expose:s}){const n=o,a=M("upload"),d=J({}),p=J(),f=t=>{if(t.length===0)return;const{autoUpload:r,limit:v,fileList:k,multiple:m,onStart:E,onExceed:l}=n;if(v&&k.length+t.length>v){l(t,k);return}m||(t=t.slice(0,1));for(const L of t){const T=L;T.uid=ve(),E(T),r&&R(T)}},R=async t=>{if(p.value.value="",!n.beforeUpload)return u(t);let r;try{r=await n.beforeUpload(t)}catch{r=!1}if(r===!1){n.onRemove(t);return}let v=t;r instanceof Blob&&(r instanceof File?v=r:v=new File([r],t.name,{type:t.type})),u(Object.assign(v,{uid:t.uid}))},u=t=>{const{headers:r,data:v,method:k,withCredentials:m,name:E,action:l,onProgress:L,onSuccess:T,onError:U,httpRequest:N}=n,{uid:V}=t,X={headers:r||{},withCredentials:m,file:t,data:v,method:k,filename:E,action:l,onProgress:z=>{L(z,t)},onSuccess:z=>{T(z,t),delete d.value[V]},onError:z=>{U(z,t),delete d.value[V]}},G=N(X);d.value[V]=G,G instanceof Promise&&G.then(X.onSuccess,X.onError)},b=t=>{const r=t.target.files;!r||f(Array.from(r))},c=()=>{n.disabled||(p.value.value="",p.value.click())},w=()=>{c()};return s({abort:t=>{Be(d.value).filter(t?([v])=>String(t.uid)===v:()=>!0).forEach(([v,k])=>{k instanceof XMLHttpRequest&&k.abort(),delete d.value[v]})},upload:R}),(t,r)=>(g(),S("div",{class:y([e(a).b(),e(a).m(t.listType),e(a).is("drag",t.drag)]),tabindex:"0",onClick:c,onKeydown:le(I(w,["self"]),["enter","space"])},[t.drag?(g(),D(vt,{key:0,disabled:t.disabled,onFile:f},{default:_(()=>[F(t.$slots,"default")]),_:3},8,["disabled"])):F(t.$slots,"default",{key:1}),B("input",{ref_key:"inputRef",ref:p,class:y(e(a).e("input")),name:t.name,multiple:t.multiple,accept:t.accept,type:"file",onChange:b,onClick:r[0]||(r[0]=I(()=>{},["stop"]))},null,42,gt)],42,yt))}});var oe=K(bt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const ne="ElUpload",kt=o=>{var s;(s=o.url)!=null&&s.startsWith("blob:")&&URL.revokeObjectURL(o.url)},$t=(o,s)=>{const n=Ee(o,"fileList",void 0,{passive:!0}),a=i=>n.value.find(t=>t.uid===i.uid);function d(i){var t;(t=s.value)==null||t.abort(i)}function p(i=["ready","uploading","success","fail"]){n.value=n.value.filter(t=>!i.includes(t.status))}const f=(i,t)=>{const r=a(t);!r||(console.error(i),r.status="fail",n.value.splice(n.value.indexOf(r),1),o.onError(i,r,n.value),o.onChange(r,n.value))},R=(i,t)=>{const r=a(t);!r||(o.onProgress(i,r,n.value),r.status="uploading",r.percentage=Math.round(i.percent))},u=(i,t)=>{const r=a(t);!r||(r.status="success",r.response=i,o.onSuccess(i,r,n.value),o.onChange(r,n.value))},b=i=>{const t={name:i.name,percentage:0,status:"ready",size:i.size,raw:i,uid:i.uid};if(o.listType==="picture-card"||o.listType==="picture")try{t.url=URL.createObjectURL(i)}catch(r){Ne(ne,r.message),o.onError(r,t,n.value)}n.value=[...n.value,t],o.onChange(t,n.value)},c=async i=>{const t=i instanceof File?a(i):i;t||Q(ne,"file to be removed not found");const r=v=>{d(v);const k=n.value;k.splice(k.indexOf(v),1),o.onRemove(v,k),kt(v)};o.beforeRemove?await o.beforeRemove(t,n.value)!==!1&&r(t):r(t)};function w(){n.value.filter(({status:i})=>i==="ready").forEach(({raw:i})=>{var t;return i&&((t=s.value)==null?void 0:t.upload(i))})}return x(()=>o.listType,i=>{i!=="picture-card"&&i!=="picture"||(n.value=n.value.map(t=>{const{raw:r,url:v}=t;if(!v&&r)try{t.url=URL.createObjectURL(r)}catch(k){o.onError(k,t,n.value)}return t}))}),x(n,i=>{for(const t of i)t.uid||(t.uid=ve()),t.status||(t.status="success")},{immediate:!0,deep:!0}),{uploadFiles:n,abort:d,clearFiles:p,handleError:f,handleProgress:R,handleStart:b,handleSuccess:u,handleRemove:c,submit:w}},wt={name:"ElUpload"},Et=H({...wt,props:xe,setup(o,{expose:s}){const n=o,a=Se(),d=je(),p=J(),{abort:f,submit:R,clearFiles:u,uploadFiles:b,handleStart:c,handleError:w,handleRemove:i,handleSuccess:t,handleProgress:r}=$t(n,p),v=P(()=>n.listType==="picture-card"),k=P(()=>({...n,fileList:b.value,onStart:c,onProgress:r,onSuccess:t,onError:w,onRemove:i}));return Ce(()=>{b.value.forEach(({url:m})=>{m!=null&&m.startsWith("blob:")&&URL.revokeObjectURL(m)})}),Re(pe,{accept:Pe(n,"accept")}),s({abort:f,submit:R,clearFiles:u,handleStart:c,handleRemove:i}),(m,E)=>(g(),S("div",null,[e(v)&&m.showFileList?(g(),D(ae,{key:0,disabled:e(d),"list-type":m.listType,files:e(b),"handle-preview":m.onPreview,onRemove:e(i)},ee({append:_(()=>[O(oe,te({ref_key:"uploadRef",ref:p},e(k)),{default:_(()=>[e(a).trigger?F(m.$slots,"trigger",{key:0}):$("v-if",!0),!e(a).trigger&&e(a).default?F(m.$slots,"default",{key:1}):$("v-if",!0)]),_:3},16)]),_:2},[m.$slots.file?{name:"default",fn:_(({file:l})=>[F(m.$slots,"file",{file:l})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):$("v-if",!0),!e(v)||e(v)&&!m.showFileList?(g(),D(oe,te({key:1,ref_key:"uploadRef",ref:p},e(k)),{default:_(()=>[e(a).trigger?F(m.$slots,"trigger",{key:0}):$("v-if",!0),!e(a).trigger&&e(a).default?F(m.$slots,"default",{key:1}):$("v-if",!0)]),_:3},16)):$("v-if",!0),m.$slots.trigger?F(m.$slots,"default",{key:2}):$("v-if",!0),F(m.$slots,"tip"),!e(v)&&m.showFileList?(g(),D(ae,{key:3,disabled:e(d),"list-type":m.listType,files:e(b),"handle-preview":m.onPreview,onRemove:e(i)},ee({_:2},[m.$slots.file?{name:"default",fn:_(({file:l})=>[F(m.$slots,"file",{file:l})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):$("v-if",!0)]))}});var St=K(Et,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const Ft=ce(St);export{Ft as E};
